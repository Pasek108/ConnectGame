"use strict";class SquaresEditor extends Editor{constructor(){super("squares"),this.dragged=null,this.level=[],this.type_input=this.container.querySelector(".type select"),this.type_input.addEventListener("input",this.updatePreview.bind(this)),this.top_connections_input=this.container.querySelector(".top input"),this.top_connections_input.addEventListener("input",this.updatePreview.bind(this)),this.right_connections_input=this.container.querySelector(".right input"),this.right_connections_input.addEventListener("input",this.updatePreview.bind(this)),this.bottom_connections_input=this.container.querySelector(".bottom input"),this.bottom_connections_input.addEventListener("input",this.updatePreview.bind(this)),this.left_connections_input=this.container.querySelector(".left input"),this.left_connections_input.addEventListener("input",this.updatePreview.bind(this));for(let t=0;t<this.previews.length;t++)this.previews[t].addEventListener("dragover",(t=>t.preventDefault())),this.previews[t].addEventListener("drop",this.dropOnPreview.bind(this)),this.previews[t].addEventListener("click",this.rotatePreviewBlock.bind(this))}load(){super.load(),this.resetPreview()}generateLevel(){this.level=SquaresUtils.generateNewLevel(this.grid_size,this.grid_size);for(let t=0;t<this.grid_size;t++)for(let e=0;e<this.grid_size;e++){if("0n"===this.level[t][e].reduce(((t,e)=>t+e))){this.tiles[t][e].dataset.data="0;0;0;0;n",this.tiles[t][e].innerHTML="";continue}const i=SquaresUtils.createBlock(this.level[t][e],[0,0,0,0],!0);this.tiles[t][e].dataset.data=this.level[t][e].join(";"),this.tiles[t][e].innerHTML="",this.tiles[t][e].appendChild(i)}}updatePreview(){const t=this.type_input.value,e=this.top_connections_input.value,i=this.right_connections_input.value,n=this.bottom_connections_input.value,s=this.left_connections_input.value;if(this.previews[0].innerHTML="",this.previews[0].dataset.data=`${e};${i};${n};${s};${t}`,0==e&&0==i&&0==n&&0==s)return;const o=SquaresUtils.createBlock([e,i,n,s,t],[0,0,0,0],!0);this.previews[0].appendChild(o)}rotatePreviewBlock(){const t=this.top_connections_input.value;this.top_connections_input.value=this.left_connections_input.value,this.left_connections_input.value=this.bottom_connections_input.value,this.bottom_connections_input.value=this.right_connections_input.value,this.right_connections_input.value=t,this.updatePreview()}dropOnPreview(t){t.preventDefault();const e=this.dragged.dataset.data.split(";");this.top_connections_input.value=e[0],this.right_connections_input.value=e[1],this.bottom_connections_input.value=e[2],this.left_connections_input.value=e[3],this.type_input.value=e[4],this.updatePreview()}resetPreview(){this.type_input.value="n",this.top_connections_input.value=0,this.right_connections_input.value=0,this.bottom_connections_input.value=0,this.left_connections_input.value=0,this.updatePreview()}}